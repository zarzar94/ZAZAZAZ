import{r as s,j as e,s as n}from"./index-DjmUyBrg.js";const z=[{id:1,text:"هل يطلب طفلك تكرار التعليمات بشكل متكرر؟"},{id:2,text:"هل يتشتت انتباهه بسهولة مع وجود ضوضاء خلفية؟"},{id:3,text:"هل يعاني من صعوبة في التمييز بين الأصوات المتشابهة؟"},{id:4,text:"هل يتضايق من الأصوات العالية أو المفاجئة؟"},{id:5,text:"هل يواجه صعوبة في اتباع التعليمات المتسلسلة؟"}],D=["نادراً","أحياناً","غالباً","دائماً"],T=["اضغط على الدائرة الزرقاء","اضغط على المربع الأخضر","اضغط على المثلث الأحمر","اضغط على الدائرة الصفراء","اضغط على المربع البنفسجي"],I=u=>u==="high"?"نوصي ببرنامج الشراكة المدرسية":u==="medium"?"جرّب اختبار التشخيص السريع":u==="low"?"احجز تقييماً متخصصاً":"ابدأ من هنا";function E({onComplete:u,onClose:d}){const[i,x]=s.useState(0),[f,j]=s.useState([]),[l,R]=s.useState(!1),p=c=>{const h=[...f,c];j(h),i<z.length-1?x(i+1):R(!0)},C=()=>{const h=f.reduce((w,m)=>w+m,0)/(z.length*3)*100;return h<=25?{result:"low",msg:"المؤشرات منخفضة. المعالجة السمعية تبدو طبيعية."}:h<=60?{result:"medium",msg:"المؤشرات متوسطة. ننصح بتقييم أولي في العيادة."}:{result:"high",msg:"المؤشرات مرتفعة. نوصي بحجز تقييم متخصص."}};if(l){const{result:c,msg:h}=C(),w={low:"#22c55e",medium:"#f59e0b",high:"#ef4444"};return e.jsx("div",{style:n.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...n.modal,maxWidth:450},onClick:m=>m.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 16px",textAlign:"center"},children:"نتيجة الاختبار"}),e.jsx("div",{style:{textAlign:"center",padding:20,borderRadius:12,background:"#0f1629",marginBottom:16},children:e.jsxs("div",{style:{fontSize:42,fontWeight:800,color:w[c]},children:[f.reduce((m,g)=>m+g,0),"/",z.length*3]})}),e.jsx("p",{style:{margin:"0 0 20px",lineHeight:1.7},children:h}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"center"},children:[e.jsx("button",{style:n.ghostBtn,onClick:d,children:"إغلاق"}),e.jsx("button",{style:n.primaryBtn,onClick:()=>u(c),children:"متابعة"})]})]})})}return e.jsx("div",{style:n.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...n.modal,maxWidth:450},onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0},children:"اختبار تشخيصي"}),e.jsx("button",{style:n.ghostBtn,onClick:d,children:"إغلاق"})]}),e.jsx("div",{style:{height:6,background:"#1a1f35",borderRadius:3,marginBottom:16},children:e.jsx("div",{style:{height:"100%",width:`${i/z.length*100}%`,background:"linear-gradient(90deg, #8a5bd1, #17c8ff)",borderRadius:3}})}),e.jsxs("p",{style:{opacity:.7,fontSize:14,margin:"0 0 8px"},children:["السؤال ",i+1," من ",z.length]}),e.jsx("h4",{style:{margin:"0 0 16px",lineHeight:1.6},children:z[i].text}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:D.map((c,h)=>e.jsx("button",{onClick:()=>p(h),style:{padding:"12px 14px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:"#0f1629",color:"#f7f8fb",cursor:"pointer",textAlign:"right"},children:c},h))})]})})}function F({onComplete:u,onClose:d}){const[i,x]=s.useState(0),[f,j]=s.useState(0),[l,R]=s.useState(0),[p,C]=s.useState(!1),[c,h]=s.useState(!1),[w,m]=s.useState(!1),[g,y]=s.useState(null),b=s.useRef(null),v=typeof window<"u"?window.AudioContext??window.webkitAudioContext:null,S=!!v,B=10,W=s.useCallback(()=>{if(!S)return null;b.current||(b.current=new v);const t=b.current;return t.state==="suspended"&&t.resume(),t},[v,S]),A=s.useCallback(t=>{const r=W();if(!r)return;const a=r.createOscillator(),k=r.createGain();a.connect(k),k.connect(r.destination),a.frequency.value=t,k.gain.value=.3,a.start(),k.gain.exponentialRampToValueAtTime(.001,r.currentTime+.5),a.stop(r.currentTime+.5)},[]),q=()=>A(880),M=s.useCallback(()=>{if(i>=B){m(!0);return}y(null);const t=Math.random()>.5;h(t),C(!0),A(t?880:440+Math.random()*400),setTimeout(()=>C(!1),600)},[i,A]),o=t=>{if(p)return;const r=t===c;y(r?"correct":"wrong"),r&&c&&j(a=>a+1),r||R(a=>a+1),x(a=>a+1),setTimeout(()=>{i+1>=B?m(!0):M()},500)};if(s.useEffect(()=>()=>{b.current?.close()},[]),w){const t=Math.round(f/B*100),r=t>=70?"low":t>=40?"medium":"high",a={low:"#22c55e",medium:"#f59e0b",high:"#ef4444"};return e.jsx("div",{style:n.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...n.modal,maxWidth:400},onClick:k=>k.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 16px",textAlign:"center"},children:"نتيجة مطابقة النغمات"}),e.jsxs("div",{style:{textAlign:"center",padding:20,borderRadius:12,background:"#0f1629",marginBottom:16},children:[e.jsxs("div",{style:{fontSize:42,fontWeight:800,color:a[r]},children:[t,"%"]}),e.jsx("div",{style:{opacity:.7},children:"الدقة"})]}),e.jsxs("p",{style:{margin:"0 0 16px"},children:["الإصابات: ",f," | الأخطاء: ",l]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"center"},children:[e.jsx("button",{style:n.ghostBtn,onClick:d,children:"إغلاق"}),e.jsx("button",{style:n.primaryBtn,onClick:()=>u(r),children:"متابعة"})]})]})})}return e.jsx("div",{style:n.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...n.modal,maxWidth:400,textAlign:"center"},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0},children:"مطابقة النغمات"}),e.jsx("button",{style:n.ghostBtn,onClick:d,children:"إغلاق"})]}),!S&&e.jsx("p",{style:{color:"#f59e0b",fontSize:12,margin:"0 0 8px"},children:"Audio is blocked or unsupported in this browser; sound cues may be muted."}),e.jsxs("p",{style:{opacity:.7,marginBottom:12},children:["الجولة ",i+1," من ",B]}),e.jsx("button",{onClick:q,style:{...n.ghostBtn,marginBottom:16},children:"استمع للنغمة المستهدفة (880Hz)"}),i===0&&!p?e.jsx("button",{onClick:M,style:n.primaryBtn,children:"ابدأ اللعبة"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:120,height:120,margin:"20px auto",borderRadius:"50%",background:g==="correct"?"#22c55e":g==="wrong"?"#ef4444":p?"#8a5bd1":"#1a1f35",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,transition:"background 0.2s"},children:p?"جاري التشغيل...":g?g==="correct"?"صحيح!":"خطأ!":"استمع"}),e.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[e.jsx("button",{onClick:()=>o(!0),disabled:p,style:{...n.primaryBtn,opacity:p?.5:1},children:"نغمة مستهدفة"}),e.jsx("button",{onClick:()=>o(!1),disabled:p,style:{...n.ghostBtn,opacity:p?.5:1},children:"نغمة مختلفة"})]})]})]})})}function L({onComplete:u,onClose:d}){const[i,x]=s.useState(0),[f,j]=s.useState(0),[l,R]=s.useState(!0),[p,C]=s.useState(!1),[c,h]=s.useState(null),[w,m]=s.useState(0),g=s.useRef(null),y=s.useRef(null),b=typeof window<"u"?window.AudioContext??window.webkitAudioContext:null,v=!!b,S=typeof window<"u"&&"speechSynthesis"in window&&typeof SpeechSynthesisUtterance<"u",B=[{id:"blue-circle",label:"الدائرة الزرقاء",color:"#3b82f6",shape:"circle"},{id:"green-square",label:"المربع الأخضر",color:"#22c55e",shape:"square"},{id:"red-triangle",label:"المثلث الأحمر",color:"#ef4444",shape:"triangle"},{id:"yellow-circle",label:"الدائرة الصفراء",color:"#eab308",shape:"circle"},{id:"purple-square",label:"المربع البنفسجي",color:"#a855f7",shape:"square"}],W=s.useCallback(o=>{if(!v)return;g.current||(g.current=new b);const t=g.current;if(t.state==="suspended"&&t.resume(),y.current&&(y.current.stop(),y.current=null),o===0)return;const r=t.sampleRate*2,a=t.createBuffer(1,r,t.sampleRate),k=a.getChannelData(0);for(let H=0;H<r;H++)k[H]=(Math.random()*2-1)*.3;const G=t.createBufferSource(),P=t.createGain();G.buffer=a,G.loop=!0,G.connect(P),P.connect(t.destination),P.gain.value=o*.15,G.start(),y.current=G},[v,b]),A=s.useCallback(o=>{if(!S)return;const t=new SpeechSynthesisUtterance(o);t.lang="ar-SA",t.rate=.9,speechSynthesis.speak(t)},[S]),q=s.useCallback(()=>{if(i>=T.length){C(!0),y.current?.stop();return}h(null),R(!0);const o=Math.min(i*.25,1);m(o),W(o),A(T[i]),setTimeout(()=>R(!1),2e3)},[i,A,W]),M=o=>{if(l)return;const t=o===B[i].id;h(t?"correct":"wrong"),t&&j(r=>r+1),x(r=>r+1),setTimeout(()=>{i+1>=T.length?(C(!0),y.current?.stop()):q()},800)};if(s.useEffect(()=>()=>{y.current?.stop(),g.current?.close()},[]),p){const o=Math.round(f/T.length*100),t=o>=80?"low":o>=50?"medium":"high",r={low:"#22c55e",medium:"#f59e0b",high:"#ef4444"};return e.jsx("div",{style:n.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...n.modal,maxWidth:400},onClick:a=>a.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 16px",textAlign:"center"},children:"نتيجة محاكاة الصف"}),e.jsx("div",{style:{textAlign:"center",padding:20,borderRadius:12,background:"#0f1629",marginBottom:16},children:e.jsxs("div",{style:{fontSize:42,fontWeight:800,color:r[t]},children:[f,"/",T.length]})}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"center"},children:[e.jsx("button",{style:n.ghostBtn,onClick:d,children:"إغلاق"}),e.jsx("button",{style:n.primaryBtn,onClick:()=>u(t),children:"متابعة"})]})]})})}return e.jsx("div",{style:n.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...n.modal,maxWidth:500},onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0},children:"محاكاة صف دراسي"}),e.jsx("button",{style:n.ghostBtn,onClick:d,children:"إغلاق"})]}),(!v||!S)&&e.jsx("p",{style:{color:"#f59e0b",fontSize:12,margin:"0 0 10px"},children:"الصوت أو التعليمات الصوتية قد لا تعمل في هذا المتصفح."}),i===0&&l?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{style:{marginBottom:16},children:"استمع للتعليمات واضغط على الشكل الصحيح"}),e.jsx("button",{onClick:q,style:n.primaryBtn,children:"ابدأ"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12,fontSize:14,opacity:.7},children:[e.jsxs("span",{children:["التعليمة ",i+1," من ",T.length]}),e.jsxs("span",{children:["مستوى الضوضاء: ",Math.round(w*100),"%"]})]}),e.jsx("div",{style:{minHeight:50,padding:12,borderRadius:10,background:"#0f1629",marginBottom:16,textAlign:"center",color:c==="correct"?"#22c55e":c==="wrong"?"#ef4444":"#f7f8fb"},children:l?"استمع للتعليمات...":c?c==="correct"?"صحيح!":"خطأ!":"اختر الشكل المناسب"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12,justifyContent:"center"},children:B.map(o=>e.jsx("button",{onClick:()=>M(o.id),disabled:l,style:{width:70,height:70,border:"none",cursor:l?"not-allowed":"pointer",background:o.color,opacity:l?.5:1,borderRadius:o.shape==="circle"?"50%":o.shape==="triangle"?0:12,clipPath:o.shape==="triangle"?"polygon(50% 0%, 0% 100%, 100% 100%)":void 0}},o.id))})]})]})})}function O(){const[u,d]=s.useState(null),[i,x]=s.useState(null),f=[{key:"quiz",title:"اختبار تشخيصي سريع",desc:"٥ أسئلة تقيس مؤشرات المعالجة السمعية."},{key:"tone",title:"مطابقة النغمات",desc:"١٠ جولات لتمييز النغمة المستهدفة 880Hz."},{key:"classroom",title:"محاكاة صف دراسي",desc:"٥ تعليمات صوتية مع ضوضاء متزايدة."}],j=l=>{d(l),x(null)};return e.jsxs("section",{id:"games",style:n.sectionCard,children:[e.jsx("div",{style:n.sectionHeaderRow,children:e.jsxs("div",{children:[e.jsx("h2",{style:n.h2,children:"الألعاب التفاعلية"}),e.jsx("p",{style:n.muted,children:"اختر لعبة لتقييم المعالجة السمعية"})]})}),e.jsx("div",{style:n.gameGrid,children:f.map(l=>e.jsxs("div",{style:n.gameCard,children:[e.jsx("h3",{style:n.h3,children:l.title}),e.jsx("p",{style:n.bodyText,children:l.desc}),e.jsx("button",{style:n.primaryBtn,onClick:()=>x(l.key),children:"ابدأ اللعبة"})]},l.key))}),e.jsxs("div",{style:{marginTop:16,padding:12,borderRadius:10,background:"#0f1629"},children:[e.jsx("strong",{children:"التوصية:"}),e.jsx("p",{style:{margin:"6px 0 0",color:u==="high"?"#ef4444":u==="medium"?"#f59e0b":u==="low"?"#22c55e":"#f7f8fb"},children:I(u)})]}),i==="quiz"&&e.jsx(E,{onComplete:j,onClose:()=>x(null)}),i==="tone"&&e.jsx(F,{onComplete:j,onClose:()=>x(null)}),i==="classroom"&&e.jsx(L,{onComplete:j,onClose:()=>x(null)})]})}export{O as default};
