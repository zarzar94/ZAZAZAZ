import{r as s,j as e,s as t}from"./index-JswnA2wK.js";const R=[{id:1,text:"هل يطلب طفلك تكرار التعليمات بشكل متكرر؟"},{id:2,text:"هل يتشتت انتباهه بسهولة مع وجود ضوضاء خلفية؟"},{id:3,text:"هل يعاني من صعوبة في التمييز بين الأصوات المتشابهة؟"},{id:4,text:"هل يتضايق من الأصوات العالية أو المفاجئة؟"},{id:5,text:"هل يواجه صعوبة في اتباع التعليمات المتسلسلة؟"}],M=["نادراً","أحياناً","غالباً","دائماً"],A=["اضغط على الدائرة الزرقاء","اضغط على المربع الأخضر","اضغط على المثلث الأحمر","اضغط على الدائرة الصفراء","اضغط على المربع البنفسجي"],P=u=>u==="high"?"نوصي ببرنامج الشراكة المدرسية":u==="medium"?"جرّب اختبار التشخيص السريع":u==="low"?"احجز تقييماً متخصصاً":"ابدأ من هنا";function H({onComplete:u,onClose:d}){const[i,g]=s.useState(0),[p,j]=s.useState([]),[l,S]=s.useState(!1),x=c=>{const h=[...p,c];j(h),i<R.length-1?g(i+1):S(!0)},k=()=>{const h=p.reduce((C,f)=>C+f,0)/(R.length*3)*100;return h<=25?{result:"low",msg:"المؤشرات منخفضة. المعالجة السمعية تبدو طبيعية."}:h<=60?{result:"medium",msg:"المؤشرات متوسطة. ننصح بتقييم أولي في العيادة."}:{result:"high",msg:"المؤشرات مرتفعة. نوصي بحجز تقييم متخصص."}};if(l){const{result:c,msg:h}=k(),C={low:"#22c55e",medium:"#f59e0b",high:"#ef4444"};return e.jsx("div",{style:t.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...t.modal,maxWidth:450},onClick:f=>f.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 16px",textAlign:"center"},children:"نتيجة الاختبار"}),e.jsx("div",{style:{textAlign:"center",padding:20,borderRadius:12,background:"#0f1629",marginBottom:16},children:e.jsxs("div",{style:{fontSize:42,fontWeight:800,color:C[c]},children:[p.reduce((f,m)=>f+m,0),"/",R.length*3]})}),e.jsx("p",{style:{margin:"0 0 20px",lineHeight:1.7},children:h}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"center"},children:[e.jsx("button",{style:t.ghostBtn,onClick:d,children:"إغلاق"}),e.jsx("button",{style:t.primaryBtn,onClick:()=>u(c),children:"متابعة"})]})]})})}return e.jsx("div",{style:t.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...t.modal,maxWidth:450},onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0},children:"اختبار تشخيصي"}),e.jsx("button",{style:t.ghostBtn,onClick:d,children:"إغلاق"})]}),e.jsx("div",{style:{height:6,background:"#1a1f35",borderRadius:3,marginBottom:16},children:e.jsx("div",{style:{height:"100%",width:`${i/R.length*100}%`,background:"linear-gradient(90deg, #8a5bd1, #17c8ff)",borderRadius:3}})}),e.jsxs("p",{style:{opacity:.7,fontSize:14,margin:"0 0 8px"},children:["السؤال ",i+1," من ",R.length]}),e.jsx("h4",{style:{margin:"0 0 16px",lineHeight:1.6},children:R[i].text}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:M.map((c,h)=>e.jsx("button",{onClick:()=>x(h),style:{padding:"12px 14px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:"#0f1629",color:"#f7f8fb",cursor:"pointer",textAlign:"right"},children:c},h))})]})})}function D({onComplete:u,onClose:d}){const[i,g]=s.useState(0),[p,j]=s.useState(0),[l,S]=s.useState(0),[x,k]=s.useState(!1),[c,h]=s.useState(!1),[C,f]=s.useState(!1),[m,y]=s.useState(null),v=s.useRef(null),B=10,w=s.useCallback(n=>{v.current||(v.current=new AudioContext);const o=v.current,a=o.createOscillator(),b=o.createGain();a.connect(b),b.connect(o.destination),a.frequency.value=n,b.gain.value=.3,a.start(),b.gain.exponentialRampToValueAtTime(.001,o.currentTime+.5),a.stop(o.currentTime+.5)},[]),z=()=>w(880),G=s.useCallback(()=>{if(i>=B){f(!0);return}y(null);const n=Math.random()>.5;h(n),k(!0),w(n?880:440+Math.random()*400),setTimeout(()=>k(!1),600)},[i,w]),r=n=>{if(x)return;const o=n===c;y(o?"correct":"wrong"),o&&c&&j(a=>a+1),o||S(a=>a+1),g(a=>a+1),setTimeout(()=>{i+1>=B?f(!0):G()},500)};if(s.useEffect(()=>()=>{v.current?.close()},[]),C){const n=Math.round(p/B*100),o=n>=70?"low":n>=40?"medium":"high",a={low:"#22c55e",medium:"#f59e0b",high:"#ef4444"};return e.jsx("div",{style:t.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...t.modal,maxWidth:400},onClick:b=>b.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 16px",textAlign:"center"},children:"نتيجة مطابقة النغمات"}),e.jsxs("div",{style:{textAlign:"center",padding:20,borderRadius:12,background:"#0f1629",marginBottom:16},children:[e.jsxs("div",{style:{fontSize:42,fontWeight:800,color:a[o]},children:[n,"%"]}),e.jsx("div",{style:{opacity:.7},children:"الدقة"})]}),e.jsxs("p",{style:{margin:"0 0 16px"},children:["الإصابات: ",p," | الأخطاء: ",l]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"center"},children:[e.jsx("button",{style:t.ghostBtn,onClick:d,children:"إغلاق"}),e.jsx("button",{style:t.primaryBtn,onClick:()=>u(o),children:"متابعة"})]})]})})}return e.jsx("div",{style:t.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...t.modal,maxWidth:400,textAlign:"center"},onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0},children:"مطابقة النغمات"}),e.jsx("button",{style:t.ghostBtn,onClick:d,children:"إغلاق"})]}),e.jsxs("p",{style:{opacity:.7,marginBottom:12},children:["الجولة ",i+1," من ",B]}),e.jsx("button",{onClick:z,style:{...t.ghostBtn,marginBottom:16},children:"استمع للنغمة المستهدفة (880Hz)"}),i===0&&!x?e.jsx("button",{onClick:G,style:t.primaryBtn,children:"ابدأ اللعبة"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:120,height:120,margin:"20px auto",borderRadius:"50%",background:m==="correct"?"#22c55e":m==="wrong"?"#ef4444":x?"#8a5bd1":"#1a1f35",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,transition:"background 0.2s"},children:x?"جاري التشغيل...":m?m==="correct"?"صحيح!":"خطأ!":"استمع"}),e.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[e.jsx("button",{onClick:()=>r(!0),disabled:x,style:{...t.primaryBtn,opacity:x?.5:1},children:"نغمة مستهدفة"}),e.jsx("button",{onClick:()=>r(!1),disabled:x,style:{...t.ghostBtn,opacity:x?.5:1},children:"نغمة مختلفة"})]})]})]})})}function I({onComplete:u,onClose:d}){const[i,g]=s.useState(0),[p,j]=s.useState(0),[l,S]=s.useState(!0),[x,k]=s.useState(!1),[c,h]=s.useState(null),[C,f]=s.useState(0),m=s.useRef(null),y=s.useRef(null),v=[{id:"blue-circle",label:"الدائرة الزرقاء",color:"#3b82f6",shape:"circle"},{id:"green-square",label:"المربع الأخضر",color:"#22c55e",shape:"square"},{id:"red-triangle",label:"المثلث الأحمر",color:"#ef4444",shape:"triangle"},{id:"yellow-circle",label:"الدائرة الصفراء",color:"#eab308",shape:"circle"},{id:"purple-square",label:"المربع البنفسجي",color:"#a855f7",shape:"square"}],B=s.useCallback(r=>{m.current||(m.current=new AudioContext);const n=m.current;if(y.current&&(y.current.stop(),y.current=null),r===0)return;const o=n.sampleRate*2,a=n.createBuffer(1,o,n.sampleRate),b=a.getChannelData(0);for(let q=0;q<o;q++)b[q]=(Math.random()*2-1)*.3;const T=n.createBufferSource(),W=n.createGain();T.buffer=a,T.loop=!0,T.connect(W),W.connect(n.destination),W.gain.value=r*.15,T.start(),y.current=T},[]),w=s.useCallback(r=>{const n=new SpeechSynthesisUtterance(r);n.lang="ar-SA",n.rate=.9,speechSynthesis.speak(n)},[]),z=s.useCallback(()=>{if(i>=A.length){k(!0),y.current?.stop();return}h(null),S(!0);const r=Math.min(i*.25,1);f(r),B(r),w(A[i]),setTimeout(()=>S(!1),2e3)},[i,w,B]),G=r=>{if(l)return;const n=r===v[i].id;h(n?"correct":"wrong"),n&&j(o=>o+1),g(o=>o+1),setTimeout(()=>{i+1>=A.length?(k(!0),y.current?.stop()):z()},800)};if(s.useEffect(()=>()=>{y.current?.stop(),m.current?.close()},[]),x){const r=Math.round(p/A.length*100),n=r>=80?"low":r>=50?"medium":"high",o={low:"#22c55e",medium:"#f59e0b",high:"#ef4444"};return e.jsx("div",{style:t.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...t.modal,maxWidth:400},onClick:a=>a.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 16px",textAlign:"center"},children:"نتيجة محاكاة الصف"}),e.jsx("div",{style:{textAlign:"center",padding:20,borderRadius:12,background:"#0f1629",marginBottom:16},children:e.jsxs("div",{style:{fontSize:42,fontWeight:800,color:o[n]},children:[p,"/",A.length]})}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"center"},children:[e.jsx("button",{style:t.ghostBtn,onClick:d,children:"إغلاق"}),e.jsx("button",{style:t.primaryBtn,onClick:()=>u(n),children:"متابعة"})]})]})})}return e.jsx("div",{style:t.modalBackdrop,onClick:d,children:e.jsxs("div",{style:{...t.modal,maxWidth:500},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0},children:"محاكاة صف دراسي"}),e.jsx("button",{style:t.ghostBtn,onClick:d,children:"إغلاق"})]}),i===0&&l?e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{style:{marginBottom:16},children:"استمع للتعليمات واضغط على الشكل الصحيح"}),e.jsx("button",{onClick:z,style:t.primaryBtn,children:"ابدأ"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12,fontSize:14,opacity:.7},children:[e.jsxs("span",{children:["التعليمة ",i+1," من ",A.length]}),e.jsxs("span",{children:["مستوى الضوضاء: ",Math.round(C*100),"%"]})]}),e.jsx("div",{style:{minHeight:50,padding:12,borderRadius:10,background:"#0f1629",marginBottom:16,textAlign:"center",color:c==="correct"?"#22c55e":c==="wrong"?"#ef4444":"#f7f8fb"},children:l?"استمع للتعليمات...":c?c==="correct"?"صحيح!":"خطأ!":"اختر الشكل المناسب"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12,justifyContent:"center"},children:v.map(r=>e.jsx("button",{onClick:()=>G(r.id),disabled:l,style:{width:70,height:70,border:"none",cursor:l?"not-allowed":"pointer",background:r.color,opacity:l?.5:1,borderRadius:r.shape==="circle"?"50%":r.shape==="triangle"?0:12,clipPath:r.shape==="triangle"?"polygon(50% 0%, 0% 100%, 100% 100%)":void 0}},r.id))})]})]})})}function F(){const[u,d]=s.useState(null),[i,g]=s.useState(null),p=[{key:"quiz",title:"اختبار تشخيصي سريع",desc:"٥ أسئلة تقيس مؤشرات المعالجة السمعية."},{key:"tone",title:"مطابقة النغمات",desc:"١٠ جولات لتمييز النغمة المستهدفة 880Hz."},{key:"classroom",title:"محاكاة صف دراسي",desc:"٥ تعليمات صوتية مع ضوضاء متزايدة."}],j=l=>{d(l),g(null)};return e.jsxs("section",{id:"games",style:t.sectionCard,children:[e.jsx("div",{style:t.sectionHeaderRow,children:e.jsxs("div",{children:[e.jsx("h2",{style:t.h2,children:"الألعاب التفاعلية"}),e.jsx("p",{style:t.muted,children:"اختر لعبة لتقييم المعالجة السمعية"})]})}),e.jsx("div",{style:t.gameGrid,children:p.map(l=>e.jsxs("div",{style:t.gameCard,children:[e.jsx("h3",{style:t.h3,children:l.title}),e.jsx("p",{style:t.bodyText,children:l.desc}),e.jsx("button",{style:t.primaryBtn,onClick:()=>g(l.key),children:"ابدأ اللعبة"})]},l.key))}),e.jsxs("div",{style:{marginTop:16,padding:12,borderRadius:10,background:"#0f1629"},children:[e.jsx("strong",{children:"التوصية:"}),e.jsx("p",{style:{margin:"6px 0 0",color:u==="high"?"#ef4444":u==="medium"?"#f59e0b":u==="low"?"#22c55e":"#f7f8fb"},children:P(u)})]}),i==="quiz"&&e.jsx(H,{onComplete:j,onClose:()=>g(null)}),i==="tone"&&e.jsx(D,{onComplete:j,onClose:()=>g(null)}),i==="classroom"&&e.jsx(I,{onComplete:j,onClose:()=>g(null)})]})}export{F as default};
